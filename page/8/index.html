<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>330k info</title>
<meta name="description" content="自転車ツーリングの記録やソフトウェアの配布、Mathematicaをメインにしたプログラミングの覚書や日ごろの雑感など。">
<meta name="generator" content="Hugo 0.21" />

<link rel="dns-prefetch" href="//fonts.googleapis.com" />
<link rel="dns-prefetch" href="//fonts.gstatic.com" />
<link rel="alternate" type="application/rss+xml" title="330k info Feed" href="https://www.330k.info/index.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,700" type="text/css" media="all" />
<link rel="stylesheet" href="/css/style.css" type="text/css" media="all" />
<script type="text/javascript" src="/js/scripts.js"></script>
<script type="text/javascript" src="/js/highlight.pack.js"></script>
<script type="text/javascript">hljs.initHighlightingOnLoad();</script>
<link rel="stylesheet" href="/css/vs.css">
<link rel="shortcut icon" href="/favicon.ico">

<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-5655726-3', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>

</head>
<body class="body body-left-sidebar mobile" itemscope="itemscope" itemtype="http://schema.org/WebPage">
	<div class="container container-outer">
		<header class="header" itemscope="itemscope" itemtype="http://schema.org/WPHeader">
			<div class="container container-inner clearfix">
				<div class="logo" role="banner" itemscope="itemscope" itemtype="http://schema.org/Brand">
					<a class="logo__link" href="/" title="330k info" rel="home">
						<h1 class="logo__title">330k info</h1>
						
					</a>
				</div>
			</div>
			
<nav class="menu" itemscope="itemscope" itemtype="http://schema.org/SiteNavigationElement">
	<ul class="menu__list">
		<li class="menu__item "><a class="menu__link" href="/bicycle/">BICYCLES</a></li>
		<li class="menu__item "><a class="menu__link" href="/essay/">ESSAYS</a></li>
		<li class="menu__item "><a class="menu__link" href="/software/">SOFTWARES</a></li>
	</ul>
</nav>

		</header>
		<div class="wrapper clearfix">


	<div class="main-content list content" role="main">
				<article class="list__item post clearfix">
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/essay/how-to-read-and-write-24bit-bitmap-files-with-vba/" rel="bookmark">VBAでビットマップ(bmp)を読み書き</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"/></svg>
				<time class="list__meta-date" datetime="2010-09-22T00:00:00">September 22, 2010</time>
			</div>
		</header>
		<div class="list__excerpt">
			会社のPCでは自由にソフトウェアをインストールすることができないので、業務で使いそうなものはExcel VBAで自作していくことにした。 まずは手始めに24ビットビットマップの読み書きを行う標準モジュールを作成した。 VBAの機能のみで実装しており、外部のライブラリには依存しない。
使い方  以下のソースをOfficeのマクロで標準モジュールとしてプロジェクトへ追加する。 ReadBitmap(&ldquo;C:***.bmp&rdquo;)で、RGBTRIPLE型の2次元配列が返る。 読み込みは一応1, 4, 8, 24, 32ビットのビットマップファイルに対応。 WriteBitmap24(&ldquo;C:***.bmp&rdquo;)で24ビットのビットマップファイルを書き込む。 おまけ機能として、ReadGIFJPEGでGIFとJPEGファイルも読み込みにも対応。  ' Bitmap module by 330k ' Copyright (C) 2010 330k, All rights reserved. Option Explicit Public Type RGBTRIPLE rgbBlue As Byte rgbGreen As Byte rgbRed As Byte End Type Private Type RGBQUAD rgbBlue As Byte rgbGreen As Byte rgbRed As Byte rgbReserved As Byte End Type Private Type BITMAPFILEHEADER bfType As String * 2 bfSize As Long bfReserved1 As Integer bfReserved2 As Integer bjOffBits As Long End Type Private Type BitmapInfoHeader biSize As Long biWidth As Long biHeight As Long biPlanes As Integer biBitCount As Integer biCompression As Long biSizeImaze As Long biXPixPerMeter As Long biYPixPerMeter As Long biClrUsed As Long biClrImporant As Long End Type ' Read a bitmap file (1, 4, 8, 24 and 32 bit) and return image as 2-dimension array of RGBTriple Public Function ReadBitmap(strFileName As String) As RGBTRIPLE() Dim i As Long Dim j As Long Dim n As Long Dim intFileNumber As Integer Dim bjHeader As BITMAPFILEHEADER Dim biHeader As BitmapInfoHeader Dim lngColors As Long Dim rgbData() As RGBTRIPLE Dim rgbTemp As RGBTRIPLE Dim rgbTable3() As RGBTRIPLE Dim rgbTable4() As RGBQUAD Dim bytTemp As Byte intFileNumber = FreeFile() Open strFileName For Binary As intFileNumber Get intFileNumber, , bjHeader Get intFileNumber, , biHeader ReDim rgbData(0 To biHeader.
		</div>
	</div>
</article>

				<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://www.330k.info/bicycle/touring/20100919-20-nagoya-kanazawa/">
			<img src="/bicycle/touring/20100919-20-nagoya-kanazawa/CIMG4835.JPG" alt="2010年09月19日〜20日 名古屋→金沢" />
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/bicycle/touring/20100919-20-nagoya-kanazawa/" rel="bookmark">2010年09月19日〜20日 名古屋→金沢</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"/></svg>
				<time class="list__meta-date" datetime="2010-09-19T21:45:14">September 19, 2010</time>
			</div>
		</header>
		<div class="list__excerpt">
			function initMap(){ var map, ctaLayer; map = new google.maps.Map(document.getElementById("map-canvas"), { center: {lat: 35.6832581, lng: 139.7555827}, zoom: 8 }); ctaLayer = new google.maps.KmlLayer({ url: "https:\/\/www.330k.info\/\/bicycle\/touring\/20100919-20-nagoya-kanazawa\/20100919.kml" }); ctaLayer.setMap(map); }   日本海側に行くなら冬になる前にしなくては！ということで思いつきで金沢まで行ってみた。 敦賀で1泊して金沢まで行き、帰りは輪行した。
1日目(名古屋→敦賀) まずは養老の滝に行く時にも使ったルートで、名古屋から国道1号→国道155号→愛知県道125号と通って木曽三川を越え、国道258号を北上して関ヶ原を目指す。 このあたりは探せばもう少し平坦なルートが有るかもしれない。
 関ヶ原古戦場に寄ってみたら鉄砲隊の実演イベントをやっていたようだが、天候があまり良くなかったので先を急いだ。
 関ヶ原からは延々と国道365号を進む。 途中何箇所か道幅が狭いところがあったものの、高低差があまりないためスピードに乗ってどんどん進めた。
しかし、木之本に到着したあたりで雨がパラつきはじめ、ルートを変更。 当初は国道365号をそのまま進んで旧北陸本線のトンネル(片側通行1.4km)を突破する予定だったが、雨がひどくなった場合に即座に輪行できるように国道8号を進んで琵琶湖を少し回って塩津から北上することにした。
賤ヶ岳トンネルは琵琶湖一周ルートでも回避されることが多い、ということは知っていたので、旧道を登る。
 塩津からはへばりながらもなんとか福井県に到達。
 18時過ぎに敦賀に到着して、気比の松原などを観光した。
  走行時間: 5時間42分11秒 走行距離: 138.88 km 平均速度: 24.3 km/h 最高速度: 61.0 km/h  2日目(敦賀→金沢) 朝8時に出発しようとしていたら、後輪がパンクしていた。 原因は少し尖った石を踏みつけていたことのようで、パッチを当てて携帯ポンプで空気を入れることで1時間ほどロス。
まずは気比神宮を外側だけ観光。
 金ヶ崎トンネルの手前で、昔ながらの洗濯場をはじめて見た。
 なお、金ヶ崎トンネルの歩道にどうやって行くのかは非常に分かりにくかった。
		</div>
	</div>
</article>

				<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://www.330k.info/bicycle/touring/20100904-05-nagoya-takamori/">
			<img src="/bicycle/touring/20100904-05-nagoya-takamori/CIMG4787.JPG" alt="2010年09月04日〜05日 名古屋〜高森" />
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/bicycle/touring/20100904-05-nagoya-takamori/" rel="bookmark">2010年09月04日〜05日 名古屋〜高森</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"/></svg>
				<time class="list__meta-date" datetime="2010-09-04T21:44:58">September 04, 2010</time>
			</div>
		</header>
		<div class="list__excerpt">
			function initMap(){ var map, ctaLayer; map = new google.maps.Map(document.getElementById("map-canvas"), { center: {lat: 35.6832581, lng: 139.7555827}, zoom: 8 }); ctaLayer = new google.maps.KmlLayer({ url: "https:\/\/www.330k.info\/\/bicycle\/touring\/20100904-05-nagoya-takamori\/20100904-05.kml" }); ctaLayer.setMap(map); }   母親の実家が現住所から140kmちょっとの丁度いい場所にあるので、峠をいくつか越えてきた。 2日間の合計獲得標高は10000mを超えたが、膝が痛むこともなく走破できたのはやはりドロップハンドルとSPDの効果だろう。
1日目(往路) 午前4時過ぎに出発。 まずは国道155号を豊田市まで進み、次に国道153号(飯田街道)に入る。 国道153号に入ったところからどんどん山を上り、いくつかトンネルをくぐる(足助トンネル、新観音トンネル、大野瀬トンネル)。
    地図に峠の名前は載ってないものの、2箇所ほど上り下りがあった。
大野瀬トンネルを抜けると長野県下伊那郡根羽村に到達。
 工事中で道路がせまくなっていたため走りにくかったが、それ以上に延々と続く登り坂でペースがどんどん落ちた。 ちょうど昼時になったので根羽村と平谷村の中間にある(地形的には峠だと思うが名前は不明)ネバーランドで昼食休憩。
 エネルギを補給したところで、往路の最高到達点となる治部坂峠(1187m)に挑む・・・が、昼食を消化しきれていなかったのか、猛烈な日差しのためかペースは一向に上がらず、500mおきに休憩せざるを得ない事態に。 なんとか自転車を押して歩くという最終手段を取ることはなく、治部坂峠を制覇。
 治部坂峠を下る間でなんとか回復し、最後の峠である寒原峠(1073m)も勢いで乗り越える。
 ちなみに写真には下り勾配7%が7.5km先までとなっているが、実際には10km程度あり、その間はずっと60km/h超で走行した。
その後は国道153号→国道256号→伊那南部広域農道(南信州フルーツライン)を通り、14時30分に無事到着。
 走行時間 : 6時間40分58秒 走行距離 : 143.74 km 平均速度 : 21.5 km/h 最高速度 : 65.8 km/h  2日目(復路) 往路では下った寒原峠からの勾配7%、長さ10kmを復路で登る気にはとてもならなかったので、中央アルプスを越えて木曽谷方面から帰ることにした。
		</div>
	</div>
</article>

				<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://www.330k.info/bicycle/touring/20100807-isejinguu-isewanisshuu/">
			<img src="/bicycle/touring/20100807-isejinguu-isewanisshuu/CIMG4488.jpg" alt="2010年08月07日 伊勢神宮&amp;伊勢湾一周" />
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/bicycle/touring/20100807-isejinguu-isewanisshuu/" rel="bookmark">2010年08月07日 伊勢神宮&amp;伊勢湾一周</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"/></svg>
				<time class="list__meta-date" datetime="2010-08-07T21:44:48">August 07, 2010</time>
			</div>
		</header>
		<div class="list__excerpt">
			function initMap(){ var map, ctaLayer; map = new google.maps.Map(document.getElementById("map-canvas"), { center: {lat: 35.6832581, lng: 139.7555827}, zoom: 8 }); ctaLayer = new google.maps.KmlLayer({ url: "https:\/\/www.330k.info\/\/bicycle\/touring\/20100807-isejinguu-isewanisshuu\/20100807.kml" }); ctaLayer.setMap(map); }   新しいシクロクロスバイク(SURLY CROSS-CHECK)が手に入ったので、ずっと温めていた伊勢湾を反時計回りに一周+伊勢神宮参りを決行。
目的は
 伊勢神宮に参拝して交通安全を祈願すること これまでの走行距離の限界に挑戦すること 9月30日に廃止される伊勢湾フェリーに乗船すること  の3つ。 鳥羽発の最終フェリーが15時20分となるため、あまりゆっくりできない。
出発は6時40分。 国道247号を北上し、今回は東海通に入って西進。弥富市で国道1号に入って木曽三川を渡り、三重県に入る。 四日市に入ってすぐ国道23号に入るも、大型車が大量に走っていて自転車には危険だったため、田んぼの中を走る道を適当に走る。
 鈴鹿あたりから国道23号に復帰し、ひたすら南下。 松阪市に入ってからは国道42号→三重県道37号と、伊勢神宮外宮へ最短距離ルートを走る。
なんとか13時前に外宮に到着。
    足早に参拝して、13時20分に外宮を出発。内宮へ急ぐ。
13時55分に内宮到着。 内宮からフェリー乗り場までは20kmちょっと。15時20分発のフェリーに乗るには10分前までにはフェリー乗り場に到着して乗船したい。 移動時間が1時間として14時10分に内宮を発たなければ。
    今回の目的の1つをきっちり果たす。
 結局内宮を出発したのは14時20分。やばい。
最短ルートである三重県道37号線を鳥羽方面へ急ぐ・・・と行きたいところだが、ここにきて延々と登り坂が続く。 なんとか25km/h以上をキープしつつ登りきり、その後平均50km/h程度で一気に海岸まで下る。
15時12分にフェリー乗り場にたどり着き、乗船券は船内発売という形で伊勢湾フェリーに飛び乗った。
 フェリーは16時10分に伊良湖へ到着。
 乗船前に記念撮影できなかったので、伊良湖でフェリー(右側)を撮る。 ちなみにこの伊勢湾フェリーは今年(2010年)9月30日で廃止されるので、その前に乗っておきたかった。
		</div>
	</div>
</article>

				<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://www.330k.info/bicycle/touring/20100719-yourounotaki/">
			<img src="/bicycle/touring/20100719-yourounotaki/CIMG4384.jpg" alt="2010年07月19日 養老の滝" />
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/bicycle/touring/20100719-yourounotaki/" rel="bookmark">2010年07月19日 養老の滝</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"/></svg>
				<time class="list__meta-date" datetime="2010-07-19T21:44:20">July 19, 2010</time>
			</div>
		</header>
		<div class="list__excerpt">
			function initMap(){ var map, ctaLayer; map = new google.maps.Map(document.getElementById("map-canvas"), { center: {lat: 35.6832581, lng: 139.7555827}, zoom: 8 }); ctaLayer = new google.maps.KmlLayer({ url: "https:\/\/www.330k.info\/\/bicycle\/touring\/20100719-yourounotaki\/20100719.kml" }); ctaLayer.setMap(map); }   浜名湖に行ったときの日焼けがひどかったため、3連休の2日目は休んで、3連休最終日は同僚と養老の滝まで行くことにした。 ルートは名古屋までは国道247号を北上し、その後国道1号を西進、その後国道155号などを通って国道258号と岐阜県道56号を北上というルート。
9時に寮を出発し、広い道路を淡々と走る。 岐阜県、三重県との県境で、木曽三川を次々と横断。
       愛知県から岐阜県、三重県と次々と新しい県に突入。 ただし三重県区間は短く、すぐにまた岐阜県に戻ることになる。
 国道258号と岐阜県道56号は小規模のアップダウンを繰り返す。 同僚が徐々に登坂で遅れるようになり、頂上付近で同僚を待つ。
 13時前に養老の滝の駐車場に到着。 駐車場の係員に尋ねて、駐車場の端っこに駐輪させてもらった。 そこからは徒歩で養老の滝を目指す。
 同僚はこの時点でへばりきってしまったいた。
 3連休最終日ということもあって、家族連れで賑わっていた。
 1.5kmほど歩いて、13時17分ついに養老の滝に到着。
 滝と駐車場の中間地点にある茶屋で昼食をとってエネルギを補給。 同僚に残された体力に不安があるため、帰りはできるかぎり平地を走り、いざとなれば同僚の実家(愛知県西部)に駆け込めるルートに変更。
休憩を入れながらだましだまし走ったものの・・・
 実家まであと5kmというところ(走行距離80km)で同僚の両足が痙攣し、ついにドロップアウト。 このあと同僚の実家から車を出してもらい、回収してもらった。
自分は自転車で同僚の実家まで追いかけ、同僚の様子を確認したのち、寮まで1人で帰った。
反省点としては、同僚の初めてのロングライドとして100km超を走らせるは少し無理だったかもしれないというところ。 まずは50km程度からのほうがいいかもしれない。
 走行時間 : 7時間30分58秒 走行距離 : 130.
		</div>
	</div>
</article>

				<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://www.330k.info/bicycle/touring/20100717-hamanako-hamanakocyclingroad/">
			<img src="/bicycle/touring/20100717-hamanako-hamanakocyclingroad/CIMG4309.jpg" alt="2010年07月17日 浜名湖&amp;浜名湖周遊自転車道" />
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/bicycle/touring/20100717-hamanako-hamanakocyclingroad/" rel="bookmark">2010年07月17日 浜名湖&amp;浜名湖周遊自転車道</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"/></svg>
				<time class="list__meta-date" datetime="2010-07-17T21:43:51">July 17, 2010</time>
			</div>
		</header>
		<div class="list__excerpt">
			function initMap(){ var map, ctaLayer; map = new google.maps.Map(document.getElementById("map-canvas"), { center: {lat: 35.6832581, lng: 139.7555827}, zoom: 8 }); ctaLayer = new google.maps.KmlLayer({ url: "https:\/\/www.330k.info\/\/bicycle\/touring\/20100717-hamanako-hamanakocyclingroad\/20100717.kml" }); ctaLayer.setMap(map); }   6月中旬に新しい自転車を注文したのだが、まだまだ納車されないようなので、3連休はルイガノのクロスバイクと過ごすことになった。 どこに行こうか、と考えてとりあえず3連休初日は浜名湖にうなぎでも食べに行って精をつけることにした。
   寮を8時に出発し、トロトロと国道1号を東進して11時頃に豊橋を通過、12時20分頃に静岡県に初めて突入。
 遠州灘が見える区間はあまりなかった。自転車はバイパス区間を通行できないので、旧道を進む。
 だいぶお腹も減ってきた13時、ようやく浜名湖(弁天島)に到着。でもお目当てのうな丼屋まではまだ遠い。
    浜名湖周遊自転車道を通って浜名湖畔を快走。 それにしても天気が良く、青空と浜名湖はとても良く映える。
 14時、ようやくうな丼にありつけた。 ちなみに本来はツーリングマップルに載っている「志ぶき」という店が目当てだったのだが、昼時を過ぎても行列ができていたので諦めた。
   昼食後に愛宕神社へお参り。
 浜名湖周遊自転車道をひたすら走る。 浜名湖周遊自転車道は全線が自転車道として独立しているわけではなく、ところどころ車道を走るところもあるのだが、何箇所か自転車道の入り口が分からなかった。
   自転車道の終点、三ヶ日からは天竜浜名湖鉄道に乗り、輪行で帰宅した。
 走行距離 : 128.5 km 走行時間 : 7時間02分53秒 平均速度 : 18.
		</div>
	</div>
</article>

				<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://www.330k.info/bicycle/touring/20100704-chitahantou/">
			<img src="/bicycle/touring/20100704-chitahantou/CIMG4288.jpg" alt="2010年07月04日 知多半島一周" />
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/bicycle/touring/20100704-chitahantou/" rel="bookmark">2010年07月04日 知多半島一周</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"/></svg>
				<time class="list__meta-date" datetime="2010-07-04T21:43:32">July 04, 2010</time>
			</div>
		</header>
		<div class="list__excerpt">
			function initMap(){ var map, ctaLayer; map = new google.maps.Map(document.getElementById("map-canvas"), { center: {lat: 35.6832581, lng: 139.7555827}, zoom: 8 }); ctaLayer = new google.maps.KmlLayer({ url: "https:\/\/www.330k.info\/\/bicycle\/touring\/20100704-chitahantou\/20100704.kml" }); ctaLayer.setMap(map); }   名古屋(の隣)に転勤になり、休日が下の写真のようなサイクリング日和になったので、1週間前に実家から新幹線で運んできたルイガノの自転車でとりあえず知多半島一周に出ることにした。コースは地図に示すように知多半島を時計回りに1周することとした。
 出発してからしばらくは街中を進むが、豊浜あたりでようやく左手に海が見えるようになる。国道247号は路肩が狭く、交通量が多くなると少し危険だった。
 2時間ほど走り、距離的にはそろそろ南端についてもおかしくないのだが、地図を持ってくるのを忘れてしまったので、どこが知多半島の先端か分からず。 適当に海に出て写真を撮る。
 もう少し進むと、羽豆岬のフェリーターミナルの案内と鳥居があった。 とりあえず目的としていた知多半島の南端には到達した。 50kmを2時間ちょっとで走ったので、かなりいいペース。
   さて、今度は知多半島西岸を北上・・・なのだが、この日はとにかく向かい風が強い。 道中で何人もの自転車野郎どもとすれ違ったが、反対車線を走る人はみんな飛ばしている。
途中で灯台を発見したので寄ってみた。 野間崎灯台というそうだ。
 その後も国道247号を進むが、常滑までのバイパス区間はアップダウンが激しい。 というか今まで飛ばしすぎたかもしれない。
名鉄常滑線を越える陸橋を迂回し、線路脇の道を走ったが、この道は直線でほとんど勾配がなく走りやすかった。 途中で自転車歴40年以上で今年65歳の方に道案内をしてもらい、その後は10km/h程度でおしゃべりをしながらゆっくり並走した。
名古屋よりも少し先の方に住んでいる、とのことだったが
 「退職してから毎日のように知多半島に走りに来ている」 「若い時は4時間で知多半島を回れたんだが、最近は6時間かかる」 「東京まで22時間で行ったことがあるが、最後に箱根の峠を越えるのはきつかった」  など、数々の武勇伝を聞かせてくれた。
自転車のほとんどのパーツを自分で組むことができるほどのテクニックをお持ちで、良くも悪くも「自転車道」に踏み入れてしまった方のようだ。
太田川を過ぎたところでその方とお別れし、最後にスピードを上げて一気に帰宅した。
 走行時間: 5時間42分39秒 (休憩込み) 走行距離: 105.0 km (GPS) 平均速度: 18.
		</div>
	</div>
</article>

				<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://www.330k.info/bicycle/touring/20100318-okunikkou/">
			<img src="/bicycle/touring/20100318-okunikkou/CIMG3839.jpg" alt="2010年03月18日 奥日光" />
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/bicycle/touring/20100318-okunikkou/" rel="bookmark">2010年03月18日 奥日光</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"/></svg>
				<time class="list__meta-date" datetime="2010-03-18T21:43:17">March 18, 2010</time>
			</div>
		</header>
		<div class="list__excerpt">
			function initMap(){ var map, ctaLayer; map = new google.maps.Map(document.getElementById("map-canvas"), { center: {lat: 35.6832581, lng: 139.7555827}, zoom: 8 }); ctaLayer = new google.maps.KmlLayer({ url: "https:\/\/www.330k.info\/\/bicycle\/touring\/20100318-okunikkou\/20100318.kml" }); ctaLayer.setMap(map); }   同期の漕艇部OBと2人で卒業旅行替わりにちょっと日帰りでポタリングした。 予定していたコースは
 東武日光駅まで輪行 いろは坂を超えて日光湯元あたりまで行く 折り返して日光駅付近まで戻る 時間が余ったら付近を観光  としていた。
走行距離は65km程度なので大した問題は起きないだろうと思っていた。
まずは本郷を7時に出発して浅草駅まで不忍池を通って走り、輪行開始。
 浅草駅08時00分発のきぬ103号に自転車とともに乗り込み、09時49分に東武日光駅に到着。 自転車を輪行袋から出して組み立てる。
 市街地を抜け、いよいよいろは坂に挑む。
 いろは坂を登り始めると道路以外の部分には残雪。
 こまめに休憩しつつ、結果的に40分ほどで明智平に到着。
   明智トンネルを抜けて中禅寺湖に到着。明智トンネルは広い歩道があったので安心して通れた。
 さらに湖畔を走って菖蒲ヶ浜へ。
 また標高を上げて戦場ヶ原に到着。夏が見頃らしいが・・・。
 湯ノ湖に到着。
   沼田方面に抜ける金精道路はまだ通行止め。
 湯ノ湖ビジターセンターで折り返す。
 さて折り返すか、としようとしたその時から天候が急変し、猛吹雪に。 前日の天気予報で降水はないと思い込んでいたのでレインウェアの用意をしていなかったことを激しく後悔。 雪で視界が殆ど無く、手と足の指先の感覚もなくなった中、急がないと路面が凍結してどうしようもなくなると思い、必死に標高を1000m下げる。
		</div>
	</div>
</article>

				<article class="list__item post clearfix">
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/essay/how-to-optimize-mathematica-programs/" rel="bookmark">Mathematicaにおけるプログラムの高速化手法</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"/></svg>
				<time class="list__meta-date" datetime="2009-12-14T22:39:00">December 14, 2009</time>
			</div>
		</header>
		<div class="list__excerpt">
			Mathematicaにおいてプログラムの実行速度を最適化する際の項目を思いつく限り挙げてみた。 高速化に関する公式のドキュメントはこちら。
関数型パラダイムで書く 必然的に組み込み関数を多く使い、リストをまとめて操作することになるので手続き型で書くより速くなることが多い。 コード量も少なくなって読みやすくなるので、よほどのことでない限りMathematicaでは関数型で書く。
具体的には、手続き型ループ構文(Do, For, Whileなど)をやめて、MapやThreadを使うようにする。
出来る限り組み込みの関数を使う 組み込み関数でできることは出来る限りやらせる。 ドキュメントを探すと、Mathematicaは意外と多くのものが組み込みでできるようになっている。
リストは全体をまとめて扱う 大概のループの中身はリストへの関数の適用や、テンソルの演算などに帰着する。
四則演算はリストにそのまま適用可能。 内積はDot、外積はCrossがあるし、それらを一般化したInner、Outerといった関数もある。
Mathematicaでは個々の要素に対する操作は記述しなくてもよい場合が多い。
myDifferences1[v_] := Table[v[[i + 1]] - v[[i]], {i, Length[v] - 1}]; (* 個々の要素を操作する *) myDifferences2[v_] := Most[RotateLeft[v] - v]; (* リスト全体をまとめて操作する *) {Timing[myDifferences1[#];], Timing[myDifferences2[#];], Timing[Differences[#];]} &amp;[RandomReal[{0, 5}, 5000000]] {{1.919, Null}, {0.296, Null}, {0.187, Null}}  リストの要素数変更を避ける 手続き型で要素数が分からないリストを生成するには、ReapとSowを用いる。AppendToやPrependToは厳禁。
myPrimeChoice1[n_] := Module[{r = {}, i}, Do[If[PrimeQ[i], AppendTo[r, i]], {i, n}]; r]; myPrimeChoice2[n_] := Module[{i}, Reap[Do[If[PrimeQ[i], Sow[i]], {i, n}]][[2, 1]]]; {Timing[myPrimeChoice1[200000];], Timing[myPrimeChoice2[200000];]} {{3.
		</div>
	</div>
</article>

				<article class="list__item post clearfix">
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/essay/explicit-runge-kutta-butcher-tableau/" rel="bookmark">陽的Runge-Kutta法のButcher tableau</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"/></svg>
				<time class="list__meta-date" datetime="2009-12-05T00:00:00">December 05, 2009</time>
			</div>
		</header>
		<div class="list__excerpt">
			 Explicit Runge-Kutta法の公式はいくつか知られているが、高次の公式になるほどButcher配列の項数が増えるため論文に誤植が多くなる。 それに気づかないまま実際に使うと、プログラムは正しく組めているはずなのに思うように精度が上がらないという落とし穴にはまってしまう。
覚書として、以下に代表的と思われる公式のButcher tableauをまとめる。
以下のButcher tableauはMathematica 8のNumericalDifferentialEquationAnalysisパッケージに含まれるRungeKuttaOrderConditionsで所定の次数条件を達成していることを確認しており、誤植が入り込まないようにそのままMathematica上で画像化している。
使用したMathematicaノートブックはこちら。 必要な人はダウンロードして自分で計算して確認した後に使用してほしい。
MathematicaにCやFortranのソースコード形式で吐かせるのが確実。
※注意事項
公式の名前や出典に関しては自信がないので、鵜呑みにしないこと。
1段1次 Euler法  2段2次 修正Euler法  Heun法  Ralston法 3段3次 Heunの3次法  Kuttaの3次法  Ralstonの3次法 4段4次 古典的Runge-Kutta法  6段5次 Runge-Kutta-Fehlberg法のうち5次の部分  Runge-Kutta-Nystroemのうち5次の部分  Butcherによる5次公式を3つ     7段6次 Hammudによるもの  9段7次 Shanksによるもの  CooperとVernerによる7次公式  11段8次 CooperとVernerによる8次公式  16段9次 Vernerによる埋め込み型公式のうち9次のもの  
		</div>
	</div>
</article>

		

		
<div class="pagination clearfix">
	<a class="pagination__item pagination__item--prev" href="/page/7/">«</a>
	<span class="pagination__item pagination__item--current">8/10</span>
	<a class="pagination__item pagination__item--next" href="/page/9/">»</a>
</div>

	</div>

<aside class="sidebar" itemscope="itemscope" itemtype="http://schema.org/WPSideBar">
	
<div class="widget-recent widget">
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/software/create_gpx_with_google_maps/">Google MapsでGPXルート作成</a></li>
			<li class="widget__item"><a class="widget__link" href="/software/simplify_gpx/">GPXトラックログを間引く・簡略化</a></li>
			<li class="widget__item"><a class="widget__link" href="/bicycle/introduction/">自転車について</a></li>
			<li class="widget__item"><a class="widget__link" href="/bicycle/equipments/">携行品・装備品</a></li>
		</ul>
	</div>
</div>
	
<div class="widget-recent widget">
	<h4 class="widget__title">Recent Posts</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/bicycle/touring/20170729-0806_hokkaido/">2017年7月29日〜8月6日 北海道 道東→道北(襟裳岬、納沙布岬、知床、宗谷岬)</a></li>
			<li class="widget__item"><a class="widget__link" href="/essay/author_dvd_from_movie_file_on_windows/">動画ファイルからDVDオーサリング</a></li>
			<li class="widget__item"><a class="widget__link" href="/essay/random_distribution_sphere_surface/">球面上の一様分布</a></li>
			<li class="widget__item"><a class="widget__link" href="/essay/zabbix_ricoh_printer_template_xml/">RICOHプリンタ・複合機用のZabbix用テンプレート</a></li>
			<li class="widget__item"><a class="widget__link" href="/essay/create_uuid_vba/">VBAでUUIDを生成</a></li>
			<li class="widget__item"><a class="widget__link" href="/bicycle/touring/20170715-17_castella_yatsugatake_kogen/">2017年07月15日〜17日 カステラ工場〜軽井沢〜八ヶ岳高原〜甲府</a></li>
			<li class="widget__item"><a class="widget__link" href="/bicycle/equipments/">携行品・装備品</a></li>
			<li class="widget__item"><a class="widget__link" href="/bicycle/introduction/">自転車について</a></li>
			<li class="widget__item"><a class="widget__link" href="/essay/input_backslach_with_us_keyboard_layout/">英語版Windows PE環境でバックスラッシュを入力</a></li>
			<li class="widget__item"><a class="widget__link" href="/essay/xubuntu1604_snort_base/">Xubuntu 16.04 &#43; Snortで簡易IDS構築</a></li>
		</ul>
	</div>
</div>

	
<div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="//google.com/search">
		<label>
			<span class="screen-reader-text">Search for:</span>
			<input class="widget-search__field" type="search" placeholder="SEARCH..." value="" name="q">
		</label>
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="https://www.330k.info/" />
	</form>
</div>
	
	
<div class="widget-social widget">
	<h4 class="widget-social__title widget__title">Social</h4>
	<div class="widget-social__content widget__content">
		<div class="widget-social__item widget__item">
			<a class="widget-social__link widget__link btn" title="GitHub" rel="noopener noreferrer" href="https://github.com/330k" target="_blank">
				<svg class="widget-social__link-icon icon-github" viewBox="0 0 384 374" width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill="#fff"><path d="m192 0c-106.1 0-192 85.8-192 191.7 0 84.7 55 156.6 131.3 181.9 9.6 1.8 13.1-4.2 13.1-9.2 0-4.6-.2-16.6-.3-32.6-53.4 11.6-64.7-25.7-64.7-25.7-8.7-22.1-21.3-28-21.3-28-17.4-11.9 1.3-11.6 1.3-11.6 19.3 1.4 29.4 19.8 29.4 19.8 17.1 29.3 44.9 20.8 55.9 15.9 1.7-12.4 6.7-20.8 12.2-25.6-42.6-4.8-87.5-21.3-87.5-94.8 0-20.9 7.5-38 19.8-51.4-2-4.9-8.6-24.3 1.9-50.7 0 0 16.1-5.2 52.8 19.7 15.3-4.2 31.7-6.4 48.1-6.5 16.3.1 32.7 2.2 48.1 6.5 36.7-24.8 52.8-19.7 52.8-19.7 10.5 26.4 3.9 45.9 1.9 50.7 12.3 13.4 19.7 30.5 19.7 51.4 0 73.7-44.9 89.9-87.7 94.6 6.9 5.9 13 17.6 13 35.5 0 25.6-.2 46.3-.2 52.6 0 5.1 3.5 11.1 13.2 9.2 76.2-25.5 131.2-97.3 131.2-182 0-105.9-86-191.7-192-191.7z"/></svg>
				<span>GitHub</span>
			</a>
		</div>
	</div>
</div>
	
<div class="widget-taglist widget">
	<h4 class="widget__title">Tags</h4>
	<div class="widget__content">
		<a class="widget__link widget__link--taglist" href="/tags/.net" title=".net">.net (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/bat" title="bat">bat (2)</a>
		<a class="widget__link widget__link--taglist" href="/tags/chrome" title="chrome">chrome (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/gmail" title="gmail">gmail (2)</a>
		<a class="widget__link widget__link--taglist" href="/tags/google-maps" title="google-maps">google-maps (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/gps" title="gps">gps (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/gpx" title="gpx">gpx (5)</a>
		<a class="widget__link widget__link--taglist" href="/tags/hta" title="hta">hta (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/java" title="java">java (2)</a>
		<a class="widget__link widget__link--taglist" href="/tags/javascript" title="javascript">javascript (3)</a>
		<a class="widget__link widget__link--taglist" href="/tags/mathematica" title="mathematica">mathematica (18)</a>
		<a class="widget__link widget__link--taglist" href="/tags/powerpoint" title="powerpoint">powerpoint (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/sql" title="sql">sql (3)</a>
		<a class="widget__link widget__link--taglist" href="/tags/ubuntu" title="ubuntu">ubuntu (6)</a>
		<a class="widget__link widget__link--taglist" href="/tags/vba" title="vba">vba (3)</a>
		<a class="widget__link widget__link--taglist" href="/tags/windows" title="windows">windows (9)</a>
		<a class="widget__link widget__link--taglist" href="/tags/wsh" title="wsh">wsh (2)</a>
		<a class="widget__link widget__link--taglist" href="/tags/%e3%82%a2%e3%83%ab%e3%82%b4%e3%83%aa%e3%82%ba%e3%83%a0" title="アルゴリズム">アルゴリズム (5)</a>
		<a class="widget__link widget__link--taglist" href="/tags/%e3%83%84%e3%83%bc%e3%83%aa%e3%83%b3%e3%82%b0" title="ツーリング">ツーリング (42)</a>
		<a class="widget__link widget__link--taglist" href="/tags/%e3%83%91%e3%83%af%e3%83%8f%e3%83%a9" title="パワハラ">パワハラ (5)</a>
		<a class="widget__link widget__link--taglist" href="/tags/%e7%94%9f%e6%b4%bb" title="生活">生活 (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/%e7%a4%be%e5%86%85se" title="社内se">社内se (12)</a>
		<a class="widget__link widget__link--taglist" href="/tags/%e8%87%aa%e8%bb%a2%e8%bb%8a" title="自転車">自転車 (9)</a>
	</div>
</div>
</aside>

	</div>
		<footer class="footer" itemscope="itemscope" itemtype="http://schema.org/WPFooter">
			<div class="container container-inner">
				<p class="footer__copyright">&copy; 2017 330k info. <span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad theme</a>.</span></p>
			</div>
		</footer>
	</div>

<script>
	var navigation = responsiveNav(".menu", {
		navClass: "menu--collapse",
	});
</script>
</body>
</html>